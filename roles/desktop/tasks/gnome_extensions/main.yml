- name: Create Gnome extension install folders
  file:
    state: directory
    path: "{{ gnome_extensions['storage']['install'] }}/"
    owner: root
    group: root

- name: Get Gnome version
  shell: gnome-shell --version | grep -o '[0-9.]*$'
  changed_when: false
  register: gnome_version

- name: Get Gnome extensions metadata
  uri:
    url: "https://extensions.gnome.org/extension-info/?shell_version={{ gnome_version.stdout }}&pk={{ item }}"
    return_content: yes
  loop: "{{ gnome_extensions['ids'] }}"
  register: gnome_extension_metadata

- name: Install extensions
  include_tasks: install.yml
  loop: "{{ gnome_extension_metadata.results }}"
  loop_control:
    loop_var: metadata


- include: config/main.yml
